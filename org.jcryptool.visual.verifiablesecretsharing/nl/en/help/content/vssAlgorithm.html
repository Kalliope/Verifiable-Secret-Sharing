<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
  "http://www.w3.org/TR/html4/loose.dtd">
  
<head></head>

<body>

<h1>The Verifiable Secret Sharing algorithm according to the Feldman scheme</h1>

<p>
	There are the natural numbers <i>n</i> and <i>t</i>. In a <i>(n,t)</i>-secret sharing protocol, a secret is shared with <i>n</i> persons. 
	Each person gets one share of the secret. If <i>t</i> persons meet, they are able to reconstruct the secret.
	If less than <i>t</i> of these shareholders get together, they aren't able to get any relevant information about the secret.
	This principle can be compared to a treasure map, which is shared between multiple individuals. 
	Only if all pieces of the map get together, they can find the treasure.
	According to that, keep in mind that each shareholder could change his/her part of the map and changing the whole meaning of the map. 
	The verifiable secret sharing algorithm according to Paul Feldman which extends Shamir's Secret Sharing is able to prevent this.
</p>

<p>
	The algorithm of Adi Shamir is based on the Lagrange polynomial interpolation and is a <i>(n,t)</i>-secret sharing protocol.
	All calculations are done within the finite field <i>&#x2124;/p*</i>.
</p>

<h2>How the algorithm works</h2>

<h3>Step 1: Setting the domain parameters and variables</h3>

<p>
	<ol>
	<li><i>n</i>: number of players</br>
	<i>n</i> has to be a natural number, <i>2 &#x2264; n</i></li>
	<li>t: number of players for the reconstruction</br>
	<i>2 &#x2264; t &#x2264; <i>n</i></i></li>
	<li><i>s</i>: secret</br>
	<i>s</i> has to be a natural number</li>
	<li><i>p</i>: This is a safe prime with the condition <i>p > 2s</i></li>
	<li><i>q</i>: biggest prime factor of (p-1)</li>
	<li><i>g</i>: is the generator and an element of the finite field <i>&#x2124;/p</i> with the multiplicative order <i>q</i></li>
	</ol>
	<p>
		The dealer sets all the parameter. Aside from <i>s</i> and the coefficients which are introduced in step 2, all the parameteres are public for all players. The coefficients and the secret are only known by the dealer.
	</p>
</p>

<h3>Step 2: Creating the polynomial</h3>
<p>
The dealer wants to share the secret <i>s &#x2208; &#x2115;</i>.
</p>
<p>
He chooses the secret, random elements <i>a<sub>i</sub> &#x2208; &#x2115;[1 &#x2264; i &#x2264; (t-1); 1 &#x2264 a &#x3C; q]</i> and creates the polynomial:</p>

<p><img src="vss_polynom.jpg"></p>
		 
<p>The polynomial has the grade <i>t-1.</i> The coefficient <i>a<sub>0</sub></i> is the secret <i>s</i>.</p>

<h3>Step 3: Distribution of the shares and commitments</h3>
	<p>
		The dealer calculates the shares for each player, <i>N<sub>i</sub> = P(i) mod q</i>. <i>i[1&#x2264;i&#x2264;n]</i> is the ID of the respective player.</br>
		Independent of that, the dealer calculates the commitments <i>Y<sub>e</sub>[0 &#x2264; e &#x2264; (t-1)]</i>.
		</br>
		The calculation of the commitments works like this:
	</p>
	<p>
		<img src="vss_compute_commitments.jpg">
	</p>
	<p>
		<i>a<sub>e</sub></i> are the coefficients.
		The commitments are used later on for checking the integrity of the shares.
	</p>
	<p>
		Now each player receives his/her share and all of the commitments.
	</p>
</p>

<h3>Step 4: Verifying the shares</h3>

<p>
	Each player should check his/her after receiving it. The check consists of the following 2 calculations.</p>

<p>Calculation 1:</p>

<p><img src="vss_check_1.jpg"></p>

<p>Calculation 2:</p>

<p><img src="vss_check_2.jpg"></p>

<p>
	In step 1 the generator <i>g</i> is exponentiated with the personal share of the respective player.</br>
	Within step 2 the commiment are exponentiated with the player-ID, which is exponentiated with the index of the product function. This calculation has to be done with each commitment and the results are multiplied with each other.</br>
	If the result of step 1 is equal to the result of step 2, the share is verified. 
	This check has to be done for each share, which has to be checked, seperately.</br>
	When the player come together to reconstruct the polynomial, the check should be done again to assure that no player has changed his/her share.
</p>

<h3>Step 5: Reconstruction</h3>

<p>
	The construction is used to restore the polynomial which has been generated by the dealer. The player can reconstruct the secret <i>s</i> from the polynomial.</br>
	To do a succesful reconstruction, at least <i>t</i> players are necessary. These players have to provide their personal share for reconstructing the polynomial.</p>
	
	<p><img src="vss_lagrange.jpg"></p>
	
	<p>
	This is the polynomial interpolation algorithm according to Lagrange.</br>
	<i>u</i> is the number of shares which have been chosen for the reconstruction. <i>k</i> and <i>l</i> are the ID's of the respective player.</br>
	The result is the polynomial <i>P'(x)</i>. If enough player are chosen, <i>P'(x)</i> is equal to the polynomial <i>P(x)</i> which has been defined in step 2 and the coefficient <i>a<sub>0</sub></i> is the secret <i>s</i>.</p>
	<p>
	If one or more of the used shares are modified, the reconstruction will deliver a wrong polynomial. That also means a wrong secret <i>s</i>.
	</p>

</body>

</html>